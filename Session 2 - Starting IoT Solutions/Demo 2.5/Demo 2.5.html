<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="demo-2.5-set-a-monitoring-alert-rule">DEMO 2.5: Set a Monitoring Alert Rule</h1><h2 id="objectives">Objectives</h2><p>Show how you can set a rule which will fire an alert in the solution when data from a device meets a specific criterion.</p><h2 id="requirements">Requirements</h2><p>An active Azure subscription. If you don’t have an account, you can create a free trial account in just a couple of minutes. For details, see <a href="http://azure.microsoft.com/pricing/free-trial/" class="uri">http://azure.microsoft.com/pricing/free-trial/</a></p><p>The free Visual Studio 2015 Community Edition is required to run a C# solution that will send messages. If you don’t have Visual Studio or if you’re not running Windows, don’t despair as you can show the code in any text editor, you just won’t be able to run it.</p><h2 id="setup">Setup</h2><p>You need the Remote Monitoring solution still running that you set up for Demo 2.1 and the solution from Demo 2.3.</p><h2 id="demo-steps">Demo Steps</h2><p>In this demo, you’ll explain how the rules in the Remote Monitoring solution work. You will add a new rule, change the device C# code to make sure you’ll get messages that will trigger the rule and finally, look at the Stream Analytics query.</p><ol style="list-style-type: decimal"><li><p>Head to the Remote Monitoring Website, click on the Rules button in the left-side menu.</p></li><li><p>If you selected the device 001, you’ll have rules already created for you. Select the one for the temperature value and click on the Edit link. If you selected another device, simply select it from the Devices list and add a new temperature rule.</p><p><img src="./media/image1.png" width="624" height="257" /></p></li><li><p>Simple change the threshold value to 100.</p><p><img src="./media/image2.png" width="624" height="635" /></p></li><li><p>Head back to Visual Studio and uncomment the following line of code. It will simply send a temperature value of 105, enough to trigger the rule.</p><p><img src="./media/image3.png" width="624" height="306" /></p></li><li><p>Press F5 to launch the application.</p><p><img src="./media/image4.png" width="624" height="326" /></p></li><li><p>Head back to the Web site and show that the messages were sent with the new value and that alarms were set.</p><p><img src="./media/image5.png" width="624" height="309" /></p></li><li><p>Head to the Azure portal. Select the Stream Analytics job that process the rules and click on the Query tile.</p><p><img src="./media/image6.png" width="624" height="243" /></p></li><li><p>Show the query.</p><p><img src="./media/image7.png" width="624" height="260" /></p></li><li><p>Explain that the query</p><ol style="list-style-type: lower-alpha"><li><p>Gets the rules from the DeviceRulesBlob input</p></li><li><p>Gets the telemetry from the IoT Hub</p></li><li><p>Uses both inputs in a Select query</p></li><li><p>Gets the device records where temperature is greater than the rule temperature</p></li><li><p>Sends the result as a message in Event Hub and in Blob storage.</p></li></ol></li><li><p>This completes demo this demo.</p></li></ol><h2 id="teardown">Teardown</h2><p>You’ll can now go back to the azureiotsuite.com portal to delete your instance of the Remote Monitoring solution.</p>
</body>
</html>
